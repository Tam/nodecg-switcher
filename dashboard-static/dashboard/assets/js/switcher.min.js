!function(e){"use strict";var n={el:document.getElementById("scenes"),clear:function(){this.el.innerHTML=""},append:function(e){this.el.appendChild(e)},active:function(){return this.el.getElementsByClassName("active")[0]}},t={get:function(e,n,t){var i=new XMLHttpRequest;i.onload=function(){i.status>=200&&i.status<400&&(n?n(i.responseText):t&&t())},i.onerror=function(){t&&t()},i.open("GET",e,!0),i.send()},parseXML:function(n){function t(e){var n={};if(e.childElementCount)for(var i=0;i<e.childNodes.length;i++){var c=e.childNodes[i],o=c.nodeName;n.hasOwnProperty(o)&&(o=o+"_"+i),n[o]=t(c)}else e.innerHTML&&(n.text=e.innerHTML);if(e.attributes&&e.attributes.length)for(var a in e.attributes)if(e.attributes.hasOwnProperty(a)){var r=e.attributes[a].nodeName,s=a;n.hasOwnProperty(r)&&(r+="_attr"),n[r]=e.attributes[s].value}return n}var i=(new e.DOMParser).parseFromString(n,"text/xml").documentElement;return t(i)},addPlaceholders:function(e){for(var t=e>0?e%4:4,i=document.createElement("span"),c=0;t>c;c++)n.append(i.cloneNode(!1))}},i={scenes:{},activeScene:"",apiUrl:"127.0.0.1:8088",hasConnection:!1,api:function(e,n,c){var o="";if(e&&e!=={}){for(var a in e)e.hasOwnProperty(a)&&(""!==o&&(o+="&"),o+=a+"="+encodeURIComponent(e[a]));o="?"+o}t.get("http://"+i.apiUrl+"/api/"+o,n,function(){i.hasConnection=!1,c()})},checkConnection:function(){i.api(null,function(){i.hasConnection=!0,i.loop()},function(){i.hasConnection=!1,setTimeout(i.checkConnection,5e3)})},switchScenes:function(e,t){e!==i.activeScene&&i.api({Function:"Cut",Input:e},function(){var c=n.active();c&&c.classList.remove("active"),t.classList.add("active"),i.activeScene=e},function(){console.error("[Switcher]","Unable to switch scenes!")})},updateScenes:function(){this.api(null,function(e){var c=t.parseXML(e),o=c.inputs,a=parseInt(c.active.text),r="",s={};for(r in o)s[r]=o[r];if(JSON.stringify(s)!==JSON.stringify(i.scenes)||o[Object.keys(o)[a-1]].key!==i.activeScene){i.scenes=s;var u=document.createElement("a"),l=0;u.setAttribute("href","#");var d=function(e,n){e.addEventListener("click",function(t){t.preventDefault(),i.switchScenes(n,e)},!0)};n.clear();var f=0;for(r in o){f++;var p=o[r],v=u.cloneNode(!0);v.setAttribute("data-id",p.key),v.innerText=p.title,d(v,p.key),f===a&&(v.classList.add("active"),i.activeScene=p.key),n.append(v),l++}t.addPlaceholders(l)}},function(){n.clear(),t.addPlaceholders(0),console.error("[Switcher]","Unable to update vMix scenes!")})},loop:function(){i.hasConnection?(i.updateScenes(),setTimeout(i.loop,1e3)):i.checkConnection()},init:function(){this.loop()}};i.init()}(window);